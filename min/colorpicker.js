function obtenerID(e){var o=document.getElementById(e);return o}function setBackgroundColor(e,o){obtenerID(o).style.backgroundColor="rgb("+e[0]+","+e[1]+","+e[2]+")"}function comprobarRGB(e){for(var o=0;3>o;o++)isNaN(e[o])||e[o]<0?e[o]=0:e[o]>255&&(e[o]=255)}function comprobarHSV(e){for(var o=0;3>o;o++)(isNaN(e[o])||e[o]<0)&&(e[o]=0);e[0]>360&&(e[0]=360),e[1]>1&&(e[1]=1),e[2]>1&&(e[2]=1)}function HSVtoRGB(e){comprobarHSV(e);var o,t,r,n=e[2]*e[1],a=n*(1-Math.abs(e[0]/60%2-1)),l=e[2]-n;return e[0]>=0&&e[0]<60?(o=n,t=a,r=0):e[0]<120?(o=a,t=n,r=0):e[0]<180?(o=0,t=n,r=a):e[0]<240?(o=0,t=a,r=n):e[0]<300?(o=a,t=0,r=n):e[0]<=360&&(o=n,t=0,r=a),o=Math.round(255*(o+l)),t=Math.round(255*(t+l)),r=Math.round(255*(r+l)),[o,t,r]}function RGBtoHSV(e){comprobarRGB(e);var o,t,r,n,a,l=e[0]/255,i=e[1]/255,s=e[2]/255;return r=Math.max(l,i,s),n=Math.min(l,i,s),a=r-n,0!=a?(r==l?(o=(i-s)/a%6,0>o&&(o=6+o)):o=r==i?(s-l)/a+2:(l-i)/a+4,o*=60,t=a/r):(o=360,t=0),[o,t,r]}function RGBtoHEX(e){comprobarRGB(e);var o=Number(e[0]).toString(16);1==o.length&&(o="0"+o);var t=Number(e[1]).toString(16);1==t.length&&(t="0"+t);var r=Number(e[2]).toString(16);return 1==r.length&&(r="0"+r),(o+t+r).toUpperCase()}function HEXtoRGB(e){return[parseInt("0x"+e.substring(0,2),16),parseInt("0x"+e.substring(2,4),16),parseInt("0x"+e.substring(4,6),16)]}function invertRGB(e){return[255-e[0],255-e[1],255-e[2]]}function webSafeColor(e){for(var o,t=[],r=0;3>r;r++)o=e[r]%51,t[r]=e[r]-o,o>=25.5&&(t[r]=t[r]+51);return t}function hsv2hsl(e){var o=(o=(2-e[1])*e[2])>=1?2-o:o;return 0==o&&(o=1),[e[0],e[1]*e[2]/o,(2-e[1])*e[2]/2]}function RGBtoString(e){return"rgb("+e[0]+","+e[1]+","+e[2]+")"}function makeInvisible(e){e.className.indexOf("visible")>=0?e.className=e.className.replace("visible","oculto"):e.className+=" oculto"}function makeVisible(e){e.className.indexOf("oculto")>=0?e.className=e.className.replace("oculto","visible"):e.className+=" visible"}function pointerPosition(e,o){var t=obtenerID("colorCursor");4>=o&&(o=4),4>=e&&(e=4),t.style.top=o-7+"px",t.style.left=e-7+"px"}function selectorPosition(e){2>=e&&(e=2),obtenerID("hueCursor").style.top=e-4+"px"}function getPosSquare(e){var o=obtenerID("pickboard"),t=e.clientX-o.getBoundingClientRect().left,r=e.clientY-o.getBoundingClientRect().top;return 0>=t?t=0:t>=pickboardHeight&&(t=pickboardHeight),0>=r?r=0:r>=pickboardHeight&&(r=pickboardHeight),[t,r]}function getPosHue(e){var o=e.clientY-obtenerID("huebar").getBoundingClientRect().top;return 0>=o?o=0:o>=huebarHeight&&(o=huebarHeight),o}function generarShades(e,o){var t=RGBtoHSV(HEXtoRGB(e)),o=obtenerID(o);if(t[2]>1/7){o.innerHTML="";for(var r=1;7>=r;r++)crearShade(RGBtoHEX(HSVtoRGB([t[0],t[1],t[2]*r/7])),o)}else o.innerHTML="Shades of #"+e+" are identical"}function generarLights(e,o){var t=HEXtoRGB(e),o=obtenerID(o);if((t[0]+t[1]+t[2])/3<229.5){o.innerHTML="";for(var r=1;7>=r;r++)crearShade(RGBtoHEX([Math.round(255-(255-t[0])*r/7),Math.round(255-(255-t[1])*r/7),Math.round(255-(255-t[2])*r/7)]),o)}else o.innerHTML="Lights of #"+e+" are identical"}function ventanaInfo(e,o){var t;return t="<div id='muestra-extended'></div>",t+="<h3 id='html-extended-color'>#"+o+", rgb("+e[0]+","+e[1]+","+e[2]+")</h3>",t+="<h3 id='shades-title'>Shades of #"+o+"</h3>",t+="<div id='extended-shades'></div>",t+="<h3 id='shades-title'>Lights of #"+o+"</h3>",t+="<div id='extended-lights'></div>"}function ventanaCodigos(e,o,t){var r;return r="<h3>CSS codes</h3>",r+="<h5>HEXADECIMAL</h5>",r+="<input type='text' spellcheck='false' value='.text {color:#"+o+";}'/>",r+="<input type='text' spellcheck='false' value='.background {background-color:#"+o+"}'/>",r+="<h5>RGB</h5>",r+="<input type='text' spellcheck='false' value='.text {color:rgb("+e[0]+","+e[1]+","+e[2]+");}'/>",r+="<input type='text' spellcheck='false' value='.background  {background-color:rgb("+e[0]+","+e[1]+","+e[2]+");}'/>",r+="<h5>HSL</h5>",r+="<input type='text' spellcheck='false' value='.text {color:hsl("+t[0]+","+t[1]+","+t[2]+");}'/>",r+="<input type='text' spellcheck='false' value='.background  {background-color:hsl("+t[0]+","+t[1]+","+t[2]+");}'/>"}function ventanaSafeColors(){var e,o;e="<h3>Web-safe colors</h3>",e+="<table id='safe-table'>";for(var t=0;6>t;t++)for(var r=0;6>r;r++){e+="<tr>";for(var n=0;6>n;n++)o=(3*t).toString(16)+(3*t).toString(16),o+=(3*r).toString(16)+(3*r).toString(16),o+=(3*n).toString(16)+(3*n).toString(16),o=o.toUpperCase(),e+="<td style='border-color:#"+o+"'>"+o+"</td>";e+="</tr>"}return e+="</table>"}function closeCtxWindow(){var e=document.getElementById("ctx-window"),o=document.getElementById("layer");makeInvisible(e),makeInvisible(o),setTimeout(function(){document.body.removeChild(e),document.body.removeChild(o)},250)}function crearLayer(){var e=document.createElement("div");e.setAttribute("id","layer"),e.setAttribute("class","oculto"),e.onclick=closeCtxWindow,document.body.appendChild(e),setTimeout(function(){makeVisible(e)},16)}function newContextualWindow(e){var o=document.getElementById("ctx-window");null!=o&&closeCtxWindow(o),o=document.createElement("div"),o.setAttribute("id","ctx-window"),o.setAttribute("class","oculto"),o.innerHTML="<div class='close-button' onclick='closeCtxWindow();'></div>",o.innerHTML+=e,document.body.appendChild(o),crearLayer(),setTimeout(function(){makeVisible(o)},1),window.scrollTo(0,0)}function coloresALosInput(e,o,t){obtenerID(hueId).value=Math.round(e[0]),obtenerID(satId).value=Math.round(100*e[1]),obtenerID(valId).value=Math.round(100*e[2]),obtenerID(redId).value=o[0],obtenerID(greenId).value=o[1],obtenerID(blueId).value=o[2],obtenerID(hexId).value=t}function mostrarColores(e,o,t){coloresALosInput(e,o,t),setBackgroundColor(o,"nuevo"),setBackgroundColor(HSVtoRGB([e[0],1,1]),"pickboard"),setBackgroundColor(webSafeColor(o),"safeColor")}function salidaColor(e,o,t){mostrarColores(e,o,t),pointerPosition(e[1]*pickboardHeight,(1-e[2])*pickboardHeight),selectorPosition((1-e[0]/360)*huebarHeight)}function oldColor(e,o){o||setBackgroundColor(e,"viejo")}function guardarColor(e,o){if(void 0!=o){var t=o.getElementsByTagName("div");t.length>=MAX_COLORS&&o.removeChild(t[MAX_COLORS-1]);var r=crearColor(e,o);o.insertBefore(r,t[0])}}function crearColor(e){var o=document.createElement("div");o.className="saved-color",o.style.backgroundColor="#"+e;var t=document.createElement("input");return t.type="text",t.value=e,t.spellcheck=!1,t.setAttribute("readonly","readonly"),o.appendChild(t),o.addEventListener("click",function(){t.select()}),o}function crearShade(e,o){var t=7;if(void 0!=o){var r=o.getElementsByTagName("div");r.length>=t&&o.removeChild(r[t-1]);var n=crearColor(e,o);o.insertBefore(n,r[0])}}function getItemStorage(e){var o=localStorage.getItem(e);return null==o&&(o=""),o}function getSavedColors(){var e=getItemStorage("savedColors");return e.length%6!=0&&(e=e.substring(0,e.length-e.length%6)),e}function checkStorage(){if("undefined"!=typeof Storage){var e,o,t=0;o=getSavedColors();for(var r=o.length/6;MAX_COLORS>r;r++)guardarColor(RGBtoHEX(randomColor()),obtenerID("saved-colors"));for(;MAX_COLORS>t&&o.length>=6;)e=o.substr(0,6),guardarColor(e,obtenerID("saved-colors")),o=o.substring(6,o.length),t++;return!0}return obtenerID("rw-fav").display="hidden",!1}function insertarColor(e){var o=getSavedColors();o.length/6>=MAX_COLORS&&(o=o.substring(6,o.length)),localStorage.setItem("savedColors",o+e)}function numAleatorio(e,o){return Math.round(Math.random()*(o-e)+e)}function randomColor(){return[numAleatorio(0,255),numAleatorio(0,255),numAleatorio(0,255)]}function createTextareaField(e,o,t){var r=document.createElement("input");r.value=o,r.setAttribute("id",e),r.setAttribute("type","text"),r.spellcheck=!1,t.appendChild(r)}function main(){var e=[360,0,1],o=[255,255,255],t="FFFFFF",r="FFFFFF",n=!1;pickboardHeight=obtenerID("pickboard").clientHeight,huebarHeight=obtenerID("huebar").clientHeight,t=getItemStorage("lastColor"),""!=t?(o=HEXtoRGB(t),e=RGBtoHSV(o),salidaColor(e,o,t),oldColor(o,!1)):t="FFFFFF";var a=function(r){var n=getPosSquare(r);pointerPosition(n[0],n[1]),e[1]=n[0]/pickboardHeight,e[2]=1-n[1]/pickboardHeight,o=HSVtoRGB(e),t=RGBtoHEX(o),mostrarColores(e,o,t)};obtenerID("pickboard").onmousedown=function(e){oldColor(o,n),a(e),document.body.className+=" non-selectable ",window.addEventListener("mousemove",__pos=function(e){a(e)}),window.addEventListener("mouseup",quitar=function(){i(),window.removeEventListener("mousemove",__pos)})};var l=function(r){var n=getPosHue(r);selectorPosition(n),e[0]=360-n/huebarHeight*360,o=HSVtoRGB(e),t=RGBtoHEX(o),mostrarColores(e,o,t)};obtenerID("huebar").onmousedown=function(e){oldColor(o,n),l(e),document.body.className+=" non-selectable ",window.addEventListener("mousemove",__posHue=function(e){l(e)}),window.addEventListener("mouseup",quitar=function(){i(),window.removeEventListener("mousemove",__posHue)})};for(var i=function(){oldColor(o,n),localStorage.setItem("lastColor",t),document.body.className=document.body.className.replace(" non-selectable ",""),obtenerID("hex").select(),window.removeEventListener("mouseup",quitar)},s=obtenerID("inputs").getElementsByTagName("input"),c=0;c<s.length;c++)s[c].onchange=function(){oldColor(o,n);var r=parseInt(this.value,10);switch(this.id){case hueId:e[0]=r,o=HSVtoRGB(e),t=RGBtoHEX(o);break;case satId:e[1]=r/100,o=HSVtoRGB(e),t=RGBtoHEX(o);break;case valId:e[2]=r/100,o=HSVtoRGB(e),t=RGBtoHEX(o);break;case redId:o[0]=r,r=o[1];case greenId:o[1]=r,r=o[2];case blueId:o[2]=r,e=RGBtoHSV(o),t=RGBtoHEX(o);break;case hexId:t=this.value,6==t.length?(t=t.toUpperCase(),o=HEXtoRGB(t),e=RGBtoHSV(o)):3==t.length?(t=t.charAt(0)+t.charAt(0)+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2),t=t.toUpperCase(),o=HEXtoRGB(t),e=RGBtoHSV(o)):7==t.length&&"#"==t.charAt(0)?(t=t.substr(1,6),t=t.toUpperCase(),o=HEXtoRGB(t),e=RGBtoHSV(o)):t=RGBtoHEX(o)}salidaColor(e,o,t),localStorage.setItem("lastColor",t)};obtenerID("rw-attach").onclick=function(){var a=obtenerID("attached-code");oldColor(o,n),n=!n,r=t,oldColor(o,n),this.classList.toggle("rw-button-active"),n?(a.innerText="#"+t,makeVisible(a),a.style.color="#"+(e[2]>.6&&e[1]<.6?"555":t)):makeInvisible(a),a.onclick=function(){t=r,o=HEXtoRGB(t),e=RGBtoHSV(o),salidaColor(e,o,r),localStorage.setItem("lastColor",t),obtenerID("hex").select()}},obtenerID("rw-info").onmousedown=function(){newContextualWindow(ventanaInfo(o,t)),setBackgroundColor(o,"muestra-extended"),generarShades(t,"extended-shades"),generarLights(t,"extended-lights")},obtenerID("rw-codes").onmousedown=function(){newContextualWindow(ventanaCodigos(o,t,hsv2hsl(e)))},obtenerID("rw-invert").onclick=function(){oldColor(o,n),o=invertRGB(o),e=RGBtoHSV(o),t=RGBtoHEX(o),salidaColor(e,o,t),localStorage.setItem("lastColor",t),obtenerID("hex").select()},obtenerID("rw-random").onclick=function(){oldColor(o,n),o=randomColor(),e=RGBtoHSV(o),t=RGBtoHEX(o),salidaColor(e,o,t),localStorage.setItem("lastColor",t),obtenerID("hex").select()},obtenerID("rw-websafe").onmousedown=function(){newContextualWindow(ventanaSafeColors())},obtenerID("safeColor").onclick=function(){oldColor(o,n),o=webSafeColor(o),e=RGBtoHSV(o),t=RGBtoHEX(o),salidaColor(e,o,t),localStorage.setItem("lastColor",t),obtenerID("hex").select()};var d=function(){for(var r=obtenerID("saved-colors").getElementsByTagName("div"),a=0;MAX_COLORS>a;a++)r[a].addEventListener("click",function(){oldColor(o,n),t=this.childNodes[0].value,o=HEXtoRGB(t),e=RGBtoHSV(o),salidaColor(e,o,t),localStorage.setItem("lastColor",t)})};checkStorage(),d(),obtenerID("rw-fav").onclick=function(){guardarColor(t,obtenerID("saved-colors")),insertarColor(t),d()}}var pickboardHeight=256,huebarHeight=256,MAX_COLORS=8,redId="red",greenId="green",blueId="blue",hueId="hue",satId="saturation",valId="value",hexId="hex";window.onload=main;